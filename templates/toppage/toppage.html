{% extends 'base.html' %}
{% load static %}
{% block title %}トップページ{% endblock %}
{% block content %}
<link rel="stylesheet" href="{% static 'toppage.css' %}">

<div class="backgrand">
    <img class="movie-image" src="{% static 'img_folder/file2.jpg' %}" alt="ホームイメージ">
</div>

<!-- スライドの外枠 -->
<div class="slide-wrapper">
    <!-- スライド（コンテンツ） -->
    <div id="slide" class="slide">
      <div>
        <a href='{% url "movie:movie_search" %}'><img src="{% static 'img_folder/search.png' %}" alt="検索画面"></a>
      </div>
      <div>
        <a href='{% url "mypage:mylist" %}'><img src="{% static 'img_folder/mylist.png' %}" alt="マイリスト画面"></a>
      </div>
      <div>
        <a href='{% url "usersearch:user_search" %}'><img src="{% static 'img_folder/account.png' %}" alt="アカウント検索画面"></a>
      </div>
      <div><!--写真のurlは後でおすすめ検索機能用の写真に変える-->
        <a href='{% url "topic:top" %}'><img src="{% static 'img_folder/Topic.png' %}" alt="特集映画"></a>
      </div>
    </div>
    <!-- 左右のボタン -->
    <span id="prev" class="prev"></span>
    <span id="next" class="next"></span>
    <!-- インジケーター -->
    <ul class="indicator" id="indicator">
      <li class="list"></li>
      <li class="list"></li>
      <li class="list"></li>
      <li class="list"></li>
    </ul>
  </div>

   <!-- スライドショーjs -->
    <script>
    const slide = document.getElementById('slide');
    const prev = document.getElementById('prev');
    const next = document.getElementById('next');
    const indicator = document.getElementById('indicator');
    const lists = document.querySelectorAll('.list');
    const totalSlides = lists.length;
    let count = 0;
    let autoPlayInterval;
    function updateListBackground() {
        for (let i = 0; i < lists.length; i++) {
            lists[i].style.backgroundColor = i === count % totalSlides ? '#000' : '#fff';
        }
    }
    function nextClick() {
        slide.classList.remove(`slide${count % totalSlides + 1}`);
        count++;
        slide.classList.add(`slide${count % totalSlides + 1}`);
        updateListBackground();
    }
    function prevClick() {
         slide.classList.remove(`slide${count % totalSlides + 1}`);
         count--;
         if (count < 0) count = totalSlides - 1;
         slide.classList.add(`slide${count % totalSlides + 1}`);
         updateListBackground();
    }
    function startAutoPlay() {
        autoPlayInterval = setInterval(nextClick, 3000);
    }
    function resetAutoPlayInterval() {
        clearInterval(autoPlayInterval);
        startAutoPlay();
    }
    next.addEventListener('click', () => {
    nextClick();
    resetAutoPlayInterval();
    });
    prev.addEventListener('click', () => {
    prevClick();
    resetAutoPlayInterval();
    });
    indicator.addEventListener('click', (event) => {
    if (event.target.classList.contains('list')) {
        const index = Array.from(lists).indexOf(event.target);
        slide.classList.remove(`slide${count % totalSlides + 1}`);
        count = index;
        slide.classList.add(`slide${count % totalSlides + 1}`);
        updateListBackground();
        resetAutoPlayInterval();
    }
    });
    startAutoPlay();
    </script>

{% endblock %}
